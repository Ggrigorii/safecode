–¢–ò–ü–´ CROSS-SITE SCRIPTING (XSS)

1. **Reflected (–û—Ç—Ä–∞–∂—ë–Ω–Ω–∞—è) XSS**  
   ‚Äî –í—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–π —Å–∫—Ä–∏–ø—Ç –ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è —á–µ—Ä–µ–∑ URL –∏–ª–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä —Ñ–æ—Ä–º—ã –∏ —Å—Ä–∞–∑—É –æ—Ç—Ä–∞–∂–∞–µ—Ç—Å—è –≤ –æ—Ç–≤–µ—Ç–µ —Å–µ—Ä–≤–µ—Ä–∞.  
   ‚Äî –¢—Ä–µ–±—É–µ—Ç, —á—Ç–æ–±—ã –∂–µ—Ä—Ç–≤–∞ –ø–µ—Ä–µ—à–ª–∞ –ø–æ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ —Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Å—Å—ã–ª–∫–µ.  
   –ü—Ä–∏–º–µ—Ä:  
     https://example.com/search?q=<script>alert(1)</script>

2. **Stored (–°–æ—Ö—Ä–∞–Ω—ë–Ω–Ω–∞—è) XSS**  
   ‚Äî –í—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–π —Å–∫—Ä–∏–ø—Ç —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ (–≤ –ë–î, –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è—Ö, –ø—Ä–æ—Ñ–∏–ª–µ) –∏ –æ—Ç–¥–∞—ë—Ç—Å—è –≤—Å–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º.  
   ‚Äî –ù–∞–∏–±–æ–ª–µ–µ –æ–ø–∞—Å–Ω—ã–π —Ç–∏–ø ‚Äî –Ω–µ —Ç—Ä–µ–±—É–µ—Ç —Å–æ—Ü–∏–∞–ª—å–Ω–æ–π –∏–Ω–∂–µ–Ω–µ—Ä–∏–∏ –ø–æ—Å–ª–µ –≤–Ω–µ–¥—Ä–µ–Ω–∏—è.  
   –ü—Ä–∏–º–µ—Ä:  
     –ó–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫ –æ—Å—Ç–∞–≤–ª—è–µ—Ç –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π:  
       <img src=x onerror="stealCookies()">

3. **DOM-based XSS**  
   ‚Äî –£—è–∑–≤–∏–º–æ—Å—Ç—å —Å—É—â–µ—Å—Ç–≤—É–µ—Ç —Ç–æ–ª—å–∫–æ –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ –∫–ª–∏–µ–Ω—Ç–∞: JavaScript —á–∏—Ç–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –∏–∑ URL/—Ö—Ä–∞–Ω–∏–ª–∏—â–∞ –∏ –≤—Å—Ç–∞–≤–ª—è–µ—Ç –≤ DOM –±–µ–∑ —Å–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏–∏.  
   ‚Äî –°–µ—Ä–≤–µ—Ä –Ω–µ —É—á–∞—Å—Ç–≤—É–µ—Ç –≤ —É—è–∑–≤–∏–º–æ—Å—Ç–∏ ‚Äî –∞–Ω–∞–ª–∏–∑ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –Ω–∞ —É—Ä–æ–≤–Ω–µ JS-–∫–æ–¥–∞.  
   –ü—Ä–∏–º–µ—Ä:  
     const name = new URLSearchParams(location.search).get('name');
     document.getElementById('welcome').innerHTML = 'Hello, ' + name;

---

–£–Ø–ó–í–ò–ú–´–ï –ö–û–ù–¢–ï–ö–°–¢–´ –ò –ü–†–ò–ú–ï–†–´

‚úÖ –ö–æ–Ω—Ç–µ–∫—Å—Ç: HTML Body  
–£—è–∑–≤–∏–º—ã–π –∫–æ–¥:  
  <div><?= $_GET['name'] ?></div>  
–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ: –≠–∫—Ä–∞–Ω–∏—Ä—É–π—Ç–µ < > " ' & ‚Üí < > &quot; &#x27; &amp;

‚úÖ –ö–æ–Ω—Ç–µ–∫—Å—Ç: HTML Attribute  
–£—è–∑–≤–∏–º—ã–π –∫–æ–¥:  
  <input value="<?= $_GET['theme'] ?>">  
–û–ø–∞—Å–Ω–æ—Å—Ç—å: –ï—Å–ª–∏ –∑–Ω–∞—á–µ–Ω–∏–µ –Ω–µ –≤ –∫–∞–≤—ã—á–∫–∞—Ö –∏–ª–∏ –∫–∞–≤—ã—á–∫–∏ –æ–¥–∏–Ω–∞—Ä–Ω—ã–µ ‚Äî –º–æ–∂–Ω–æ –∑–∞–∫—Ä—ã—Ç—å –∞—Ç—Ä–∏–±—É—Ç.  
–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ: –í—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–∞–≤—ã—á–∫–∏ + —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ.

‚úÖ –ö–æ–Ω—Ç–µ–∫—Å—Ç: JavaScript (–≤–Ω—É—Ç—Ä–∏ <script>)  
–£—è–∑–≤–∏–º—ã–π –∫–æ–¥:  
  <script>var userId = '<?= $user_id ?>';</script>  
–û–ø–∞—Å–Ω–æ—Å—Ç—å: –ï—Å–ª–∏ $user_id = '; alert(1); // ‚Äî –∫–æ–¥ –≤—ã–ø–æ–ª–Ω–∏—Ç—Å—è.  
–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ: –ù–µ –≤—Å—Ç–∞–≤–ª—è–π—Ç–µ –¥–∞–Ω–Ω—ã–µ –Ω–∞–ø—Ä—è–º—É—é. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ JSON-–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ:  
  var userId = <?= json_encode($user_id, JSON_HEX_TAG | JSON_HEX_AMP | JSON_HEX_QUOT) ?>;

‚úÖ –ö–æ–Ω—Ç–µ–∫—Å—Ç: URL (href, src)  
–£—è–∑–≤–∏–º—ã–π –∫–æ–¥:  
  <a href="<?= $_GET['redirect'] ?>">Click</a>  
–û–ø–∞—Å–Ω–æ—Å—Ç—å: redirect=javascript:stealData()  
–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ: –í–∞–ª–∏–¥–∏—Ä—É–π—Ç–µ URL ‚Äî —Ä–∞–∑—Ä–µ—à–∞–π—Ç–µ —Ç–æ–ª—å–∫–æ http/https, –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ –¥–æ–º–µ–Ω.

---

–ü–†–ò–ú–ï–†–´ –£–Ø–ó–í–ò–ú–û–°–¢–ï–ô –ü–û –Ø–ó–´–ö–ê–ú

üêç **Python (Flask)**  
–£—è–∑–≤–∏–º–æ:  
  return f"<h1>Hello {request.args.get('name')}</h1>"  
–ë–µ–∑–æ–ø–∞—Å–Ω–æ:  
  from markupsafe import escape  
  return f"<h1>Hello {escape(request.args.get('name'))}</h1>"  
–ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —à–∞–±–ª–æ–Ω—ã —Å autoescape (–≤–∫–ª—é—á–µ–Ω–æ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –≤ Jinja2).

üåê **JavaScript (Frontend)**  
–£—è–∑–≤–∏–º–æ:  
  document.getElementById('bio').innerHTML = userProfile.bio;  
–ë–µ–∑–æ–ø–∞—Å–Ω–æ:  
  document.getElementById('bio').textContent = userProfile.bio;  
–ï—Å–ª–∏ HTML –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω ‚Äî —Å–∞–Ω–∏—Ä—É–π—Ç–µ —á–µ—Ä–µ–∑ DOMPurify:  
  const clean = DOMPurify.sanitize(userProfile.bio);  
  el.innerHTML = clean;

‚òï **Java (JSP)**  
–£—è–∑–≤–∏–º–æ:  
  <%= request.getParameter("q") %>  
–ë–µ–∑–æ–ø–∞—Å–Ω–æ:  
  <c:out value="${param.q}" />  
–ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ OWASP Java Encoder:  
  <%= Encode.forHtml(request.getParameter("q")) %>

üêò **PHP**  
–£—è–∑–≤–∏–º–æ:  
  echo "<div>" . $_GET['msg'] . "</div>";  
–ë–µ–∑–æ–ø–∞—Å–Ω–æ:  
  echo "<div>" . htmlspecialchars($_GET['msg'], ENT_QUOTES, 'UTF-8') . "</div>";

---

–ó–ê–©–ò–¢–ù–´–ï –ú–ï–•–ê–ù–ò–ó–ú–´

1. **–≠–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ (Output Encoding)**  
   ‚Äî –í—Å–µ–≥–¥–∞ –∫–æ–¥–∏—Ä—É–π—Ç–µ –¥–∞–Ω–Ω—ã–µ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ (HTML, JS, URL, CSS).  
   ‚Äî –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏:  
     ‚Ä¢ Python: `markupsafe.escape`  
     ‚Ä¢ Java: OWASP Java Encoder  
     ‚Ä¢ PHP: `htmlspecialchars()`  
     ‚Ä¢ JavaScript: DOMPurify (–¥–ª—è HTML), `textContent` (–¥–ª—è —Ç–µ–∫—Å—Ç–∞)

2. **Content Security Policy (CSP)**  
   ‚Äî –î–æ–±–∞–≤—å—Ç–µ HTTP-–∑–∞–≥–æ–ª–æ–≤–æ–∫:  
     Content-Security-Policy: default-src 'self'; script-src 'self' 'unsafe-inline'  
   ‚Äî –õ—É—á—à–µ –∏–∑–±–µ–≥–∞—Ç—å `'unsafe-inline'` ‚Äî –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ nonce/hashes.  
   ‚Äî CSP –Ω–µ –∑–∞–º–µ–Ω—è–µ—Ç —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ, –Ω–æ —Å–Ω–∏–∂–∞–µ—Ç –ø–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è XSS.

3. **–®–∞–±–ª–æ–Ω–∏–∑–∞—Ç–æ—Ä—ã —Å Autoescape**  
   ‚Äî Jinja2 (Python), Thymeleaf (Java), React (JS) –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é —ç–∫—Ä–∞–Ω–∏—Ä—É—é—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ.  
   ‚Äî –ù–∏–∫–æ–≥–¥–∞ –Ω–µ –æ—Ç–∫–ª—é—á–∞–π—Ç–µ autoescape –±–µ–∑ –∫—Ä–∞–π–Ω–µ–π –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏.

4. **–°–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏—è HTML (–µ—Å–ª–∏ –≤–≤–æ–¥ –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å —Ä–∞–∑–º–µ—Ç–∫—É)**  
   ‚Äî –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏:  
     ‚Ä¢ DOMPurify (JavaScript)  
     ‚Ä¢ Bleach (Python)  
     ‚Ä¢ OWASP AntiSamy (Java)

5. **HttpOnly –∏ Secure —Ñ–ª–∞–≥–∏ –¥–ª—è cookies**  
   ‚Äî –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ:  
     Set-Cookie: session=abc123; HttpOnly; Secure; SameSite=Strict  
   ‚Äî –≠—Ç–æ –Ω–µ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç XSS, –Ω–æ –∑–∞—â–∏—â–∞–µ—Ç –æ—Ç –∫—Ä–∞–∂–∏ —Å–µ—Å—Å–∏–π —á–µ—Ä–µ–∑ `document.cookie`.

---

–ß–ï–ì–û –ù–ï–õ–¨–ó–Ø –î–ï–õ–ê–¢–¨

‚ùå –ü–æ–ª–∞–≥–∞—Ç—å—Å—è —Ç–æ–ª—å–∫–æ –Ω–∞ "—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—é —Ç–µ–≥–æ–≤" –≤—Ä–æ–¥–µ:  
   input.replace(/<script>/g, '')  
   ‚Äî –û–±—Ö–æ–¥–∏—Ç—Å—è –ª–µ–≥–∫–æ: `<scr<script>ipt>`, `<img onerror=...>`, –∏ —Ç.–¥.

‚ùå –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `innerHTML` —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–º –≤–≤–æ–¥–æ–º –±–µ–∑ —Å–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏–∏.

‚ùå –î—É–º–∞—Ç—å, —á—Ç–æ "–º—ã —ç–∫—Ä–∞–Ω–∏—Ä—É–µ–º –Ω–∞ –≤—Ö–æ–¥–µ" ‚Äî —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –Ω–∞ –≤—ã—Ö–æ–¥–µ (–≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è).

‚ùå –ò–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å DOM-based XSS ‚Äî –æ–Ω–∞ –Ω–µ –≤–∏–¥–Ω–∞ —Å–µ—Ä–≤–µ—Ä—É, –Ω–æ —Ç–∞–∫ –∂–µ –æ–ø–∞—Å–Ω–∞.

---

–î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–´–ï –†–ï–°–£–†–°–´

‚Ä¢ OWASP XSS Prevention Cheat Sheet:  
  https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html

‚Ä¢ PortSwigger XSS Academy (–∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–µ –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–∏–∏):  
  https://portswigger.net/web-security/cross-site-scripting

‚Ä¢ CWE-79:  
  https://cwe.mitre.org/data/definitions/79.html

‚Ä¢ DOMPurify (–±–∏–±–ª–∏–æ—Ç–µ–∫–∞ —Å–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏–∏):  
  https://github.com/cure53/DOMPurify