[A01:2021] Broken Access Control
Описание: Ограничения, определяющие, какие пользователи могут получить доступ к каким ресурсам, не работают должным образом.
Ключевые факты: 
- Поднялось с 5-го места в прошлой версии.
- Протестировано в 94% приложений.
- Включает 34 CWE — больше, чем любая другая категория.
Рекомендации:
- Внедряйте проверку прав доступа на каждом уровне (включая API и UI).
- Отказывайтесь от "скрытого" управления доступом (security through obscurity).
- Используйте модели RBAC/ABAC.
- По умолчанию запрещайте всё, разрешайте явно.

---
[A02:2021] Cryptographic Failures
Описание: Сбои в криптографии, приводящие к раскрытию чувствительных данных или компрометации системы.
Ключевые факты:
- Ранее называлось "Sensitive Data Exposure" (симптом, а не причина).
- Теперь фокус на корневых причинах: слабые алгоритмы, отсутствие шифрования, неправильное управление ключами.
Рекомендации:
- Шифруйте данные в покое и при передаче (TLS 1.2+).
- Хешируйте пароли с помощью bcrypt, scrypt или Argon2.
- Не используйте устаревшие алгоритмы (MD5, SHA1, DES).

---
[A03:2021] Injection
Описание: Передача недоверенных данных в интерпретатор как часть команды или запроса.
Ключевые факты:
- Сдвинулось на 3-е место.
- Протестировано в 94% приложений.
- Включает 33 CWE, включая XSS (теперь часть этой категории).
Рекомендации:
- Используйте параметризованные запросы (Prepared Statements).
- Валидируйте и санируйте весь ввод.
- Используйте ORM с защитой от инъекций.
- Экранируйте выходные данные при генерации кода.

---
[A04:2021] Insecure Design
Описание: Уязвимости, вызванные фундаментальными недостатками в архитектуре или проектировании.
Ключевые факты:
- Новая категория в 2021 году.
- Требует "сдвига влево" (shift left): угрозы должны анализироваться на этапе проектирования.
Рекомендации:
- Применяйте threat modeling (например, STRIDE).
- Используйте проверенные secure design patterns.
- Внедряйте контрольные списки безопасности на этапе проектирования.
- Проводите архитектурные ревью безопасности.

---
[A05:2021] Security Misconfiguration
Описание: Неправильная настройка систем, платформ, серверов или приложений.
Ключевые факты:
- Поднялось с 6-го места.
- Протестировано в 90% приложений.
- Включает бывшую категорию XXE (XML External Entities).
Рекомендации:
- Удаляйте неиспользуемые функции, страницы, аккаунты.
- Используйте безопасные настройки "из коробки".
- Автоматизируйте проверку конфигураций (например, через CIS Benchmarks).
- Регулярно обновляйте и патчите системы.

---
[A06:2021] Vulnerable and Outdated Components
Описание: Использование компонентов (библиотек, фреймворков) с известными уязвимостями.
Ключевые факты:
- Был на 9-м месте в 2017, теперь — 6-й.
- #2 по результатам опроса сообщества.
- Единственная категория без прямых CVE (оценка риска по умолчанию = 5.0).
Рекомендации:
- Ведите инвентарь зависимостей (SBOM).
- Используйте инструменты: OWASP Dependency-Check, Snyk, Dependabot.
- Обновляйте компоненты своевременно.
- Удаляйте неиспользуемые зависимости.

---
[A07:2021] Identification and Authentication Failures
Описание: Слабые механизмы аутентификации и управления сессиями.
Ключевые факты:
- Ранее назывался "Broken Authentication".
- Сдвинулся с 2-го места вниз.
- Улучшения связаны с распространением стандартных фреймворков (OAuth, OpenID Connect).
Рекомендации:
- Реализуйте многофакторную аутентификацию (MFA).
- Ограничьте попытки входа (защита от брутфорса).
- Используйте надёжные сессионные токены (длинные, случайные, с TTL).
- Не храните пароли в логах.

---
[A08:2021] Software and Data Integrity Failures
Описание: Нарушение целостности программного обеспечения или данных из-за отсутствия проверок.
Ключевые факты:
- Новая категория в 2021.
- Включает "Insecure Deserialization" из OWASP Top 10:2017.
- Имеет один из самых высоких показателей воздействия (CVSS).
Рекомендации:
- Проверяйте цифровые подписи обновлений.
- Используйте trusted repositories для зависимостей.
- Валидируйте целостность CI/CD-пайплайнов.
- Избегайте десериализации недоверенных данных.

---
[A09:2021] Security Logging and Monitoring Failures
Описание: Недостаточное логирование, мониторинг и реагирование на инциденты.
Ключевые факты:
- Ранее "Insufficient Logging & Monitoring".
- Добавлено по результатам опроса (#3).
- Сложно тестировать, плохо представлено в CVE/CVSS.
Рекомендации:
- Логируйте события входа, доступа, ошибок.
- Интегрируйте SIEM-системы.
- Настройте алерты на подозрительную активность.
- Проводите регулярные учения по реагированию на инциденты.

---
[A10:2021] Server-Side Request Forgery (SSRF)
Описание: Атакующий заставляет сервер выполнять запросы к внутренним или внешним ресурсам.
Ключевые факты:
- Добавлено по результатам опроса сообщества (#1).
- Низкая частота в данных, но высокий потенциал эксплуатации и воздействия.
Рекомендации:
- Не принимайте URL от пользователя напрямую.
- Используйте белые списки доменов.
- Отключите ненужные протоколы (file://, gopher://, dict://).
- Изолируйте сервисы, имеющие доступ к внутренней сети.

---